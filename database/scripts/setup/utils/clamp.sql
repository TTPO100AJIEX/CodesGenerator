CREATE FUNCTION CLAMP(lower BIGINT, value BIGINT, upper BIGINT) RETURNS BIGINT
LANGUAGE SQL STABLE LEAKPROOF STRICT PARALLEL SAFE RETURN ( GREATEST(LEAST(value, upper), lower) );